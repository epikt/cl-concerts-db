{% extends "base.html" %}
{% import 'bootstrap/wtf.html' as wtf %}

</style>

{% block app_content %}
<style type="text/css">
	.event-tabs{
		margin: 20px;
	}
</style>	
    <h1>{{ title }}</h1>
    <form action="" method="post">
    {{ form.hidden_tag() }}
    
    <div class="event-tabs">
      <ul class="nav nav-tabs" id="myTab">
            <li><a data-toggle="tab" href="#sectionGeneralInfo">{{ _("Información General") }}</a></li>
            <li><a data-toggle="tab" href="#sectionParticipants">{{ _("Participantes")}} </a></li>
            <li><a data-toggle="tab" href="#sectionRepertoire">{{ _("Repertorio")}} </a></li>
            <li><a data-toggle="tab" href="#sectionMedia">{{ _("Media")}} </a></li>           
     </ul>
     <div class="tab-content">

        <div id="sectionGeneralInfo" class="tab-pane fade in active">
            <div><h2>{{ _("Información General") }} </h2></div>
            {{ form.name.label }} <br>
            {{ form.name(size=45) }} <br>                

            {% for error in form.name.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
             <br><br>
            {{ form.event_date.label }} <br>
            {{ form.event_date }} <br>                

            {% for error in form.event_date.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
            <br><br>      
                        
            {{ form.location.label }} <br>
            {{ form.location( **{"class":"dd_select2", "url":"locations", "description":_("Lugar"),  "maxelem":"1" , "selectedElements":selectedLocation } ) }}  
                      <a href="{{ url_for('main.NewLocation') }}" target="_blank" class="btn btn-primary" role="button"> {{ _("Nuevo") }} </a>
            <br> 
            {% for error in form.location.errors %}
                 <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
            <br><br> 
            {{ form.organization.label }} <br>
            {{ form.organization( **{"class":"dd_select2", "url":"organizations", "description":_("Organización"),  "maxelem":"1" , "selectedElements":selectedOrganization } ) }} 
                  <a href="{{ url_for('main.NewOrganization') }}" target="_blank" class="btn btn-primary" role="button"> {{ _("Nuevo") }}</a> 
            <br> 
            {% for error in form.organization.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
            <br><br> 
        
            {{ form.event_type.label }} <br>
            {{ form.event_type( **{"class":"dd_select2", "url":"eventtypes", "description":_("Tipo de Evento"),  "maxelem":"1" , "selectedElements":selectedEventType } ) }} 
                <a href="{{ url_for('main.NewEventType') }}" target="_blank" class="btn btn-primary" role="button">{{ _("Nuevo") }} </a> 
            <br> 
            {% for error in form.event_type.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
             <br><br>         
                        
            {{ form.information.label }} <br>
            {{ form.information(cols="55", rows="15")|safe }} <br>                
            
            {% for error in form.information.errors %}
                <span style="color: red;">[{{ error }}]</span>
            {% endfor %}
            <br>
            {{ form.submit() }} 
        </div>
        
        <div id="sectionParticipants" class="tab-pane fade">
        
            <div><h2>{{ _("Participantes") }} </h2> </div>
            {{ _("Agregar participante: ")}}
            {{ form.person( **{"class":"dd_select2", "url":"people", "description":_("Persona"),  "maxelem":"1", "selectedElements" : "" } ) }}
            {{ form.activity( **{"class":"dd_select2", "url":"activities", "description":_("Actividad"),  "maxelem":"1", "selectedElements" : "" } ) }}
            <button type="button"  onclick="addParticipant({{event_id}})" class="btn btn-primary">Agregar</button>
            <table id="table-participants"
               data-toggle="table"
               data-show-footer="false"
               data-side-pagination="server"
               data-only-info-pagination="false"
               data-pagination="true"
               data-url={{ url_for("main.getParticipantsListTable",event_id=event_id) }}  >
                <thead>
                    <tr>
                        <th data-field="name">{{ _("Nombre") }}</th>
                        <th data-field="activity">{{ _("Actividad") }}</th>
                        <th data-field="id" data-formatter="deleteParticipantCol"></th>
                    </tr>
                </thead>
            </table> 
        </div>
        <div id="sectionRepertoire" class="tab-pane fade">
        
            <div><h2>{{ _("Repertorio") }}</h2> </div>
            {{ _("Agregar Interpretación")}}
            {{ form.musical_piece( **{"class":"dd_select2", "url":"musicalpieces", "description":_("Obra"),  "maxelem":"1", "selectedElements" : "" } ) }}
            {{ form.premiere_type( **{"class":"dd_select2", "url":"premieretypes", "description":_("Estreno"),  "maxelem":"1", "selectedElements" : "" } ) }}
            <button type="button"  onclick="addPerformance({{event_id}})" class="btn btn-primary">Agregar</button>
            
            <table id="table-musical-pieces"
               data-toggle="table"
               data-show-footer="false"
               data-only-info-pagination="false"
               data-side-pagination="server"
               data-striped="true"
               data-pagination="true"
               data-url={{ url_for("main.getPerformancesListTable",event_id=event_id) }}  >
                <thead>
                    <tr>
                        <th data-field="text">{{ _("Obra") }}</th>
                        <th data-field="id" data-formatter="deletePerformanceCol"></th>
                    </tr>
                </thead>
            </table>
            <br>
            <div><h2>{{ _("Detalle de Participación") }}</h2> </div>
            {{ _("Agregar")}}
            {{ form.performance( **{"class":"dd_select2", "url":"performances/"+event_id, "description":_("Interpretación"),  "maxelem":"1", "selectedElements" : "" } ) }}
            {{ form.participant( **{"class":"dd_select2", "url":"participants/"+event_id, "description":_("Participante"),  "maxelem":"1", "selectedElements" : "" } ) }}
            <button type="button"  onclick="addPerformanceDetail({{event_id}})" class="btn btn-primary">Agregar</button>
            
            <table id="table-performance-participant"
               data-toggle="table"
               data-show-footer="false"
               data-only-info-pagination="false"
               data-side-pagination="server"
               data-pagination="true"
               data-url={{ url_for("main.getPerformanceDetailList",event_id=event_id) }}  >
                <thead>
                    <tr>
                        <th data-field="performance_name">Obra</th>
                        <th data-field="participant_name">Nombre</th>
                        <th data-field="participant_activity">Actividad</th>
                        <th data-field="performance_participant_id" data-formatter="deletePerformanceDetailCol"></th>
                    </tr>
                </thead>
            </table>
            <br>
             
        </div>
        <div id="sectionMedia" class="tab-pane fade">
        </div>
    </div>
    </form>


{% endblock %}
{% block scripts %}
{{ super() }}

<script src="{{url_for('static', filename='js/events.js')}}"></script>

{% endblock %}
